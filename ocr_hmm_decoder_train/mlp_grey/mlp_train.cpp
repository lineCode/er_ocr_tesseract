#include <cstdlib>
#include "opencv/cv.h"
#include "opencv/ml.h"
#include <vector>
#include <fstream>

using namespace std;
using namespace cv;

static const char* ascii[62] = {"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9"};

int main(int argc, char** argv) {
/* STEP 1. Loading training data from file */
//2. Read the file
ifstream infile("all_train_data.txt");

int num_samples = 55980; //number of lines in the dataset file
int num_classes = 62; //number of classes
int num_features = 999; //number of features

Mat hus = Mat(num_samples,num_features,CV_64FC1);
Mat labels = Mat::ones(num_samples,num_classes,CV_64FC1);
labels = labels * -1;
int label;
int count = 0;


while (infile >> label >> hus.at<double>(count,0) >> hus.at<double>(count,1) >> hus.at<double>(count,2) >> hus.at<double>(count,3) >> hus.at<double>(count,4) >> hus.at<double>(count,5) >> hus.at<double>(count,6) >> hus.at<double>(count,7) >> hus.at<double>(count,8) >> hus.at<double>(count,9) >> hus.at<double>(count,10) >> hus.at<double>(count,11) >> hus.at<double>(count,12) >> hus.at<double>(count,13) >> hus.at<double>(count,14) >> hus.at<double>(count,15) >> hus.at<double>(count,16) >> hus.at<double>(count,17) >> hus.at<double>(count,18) >> hus.at<double>(count,19) >> hus.at<double>(count,20) >> hus.at<double>(count,21) >> hus.at<double>(count,22) >> hus.at<double>(count,23) >> hus.at<double>(count,24) >> hus.at<double>(count,25) >> hus.at<double>(count,26) >> hus.at<double>(count,27) >> hus.at<double>(count,28) >> hus.at<double>(count,29) >> hus.at<double>(count,30) >> hus.at<double>(count,31) >> hus.at<double>(count,32) >> hus.at<double>(count,33) >> hus.at<double>(count,34) >> hus.at<double>(count,35) >> hus.at<double>(count,36) >> hus.at<double>(count,37) >> hus.at<double>(count,38) >> hus.at<double>(count,39) >> hus.at<double>(count,40) >> hus.at<double>(count,41) >> hus.at<double>(count,42) >> hus.at<double>(count,43) >> hus.at<double>(count,44) >> hus.at<double>(count,45) >> hus.at<double>(count,46) >> hus.at<double>(count,47) >> hus.at<double>(count,48) >> hus.at<double>(count,49) >> hus.at<double>(count,50) >> hus.at<double>(count,51) >> hus.at<double>(count,52) >> hus.at<double>(count,53) >> hus.at<double>(count,54) >> hus.at<double>(count,55) >> hus.at<double>(count,56) >> hus.at<double>(count,57) >> hus.at<double>(count,58) >> hus.at<double>(count,59) >> hus.at<double>(count,60) >> hus.at<double>(count,61) >> hus.at<double>(count,62) >> hus.at<double>(count,63) >> hus.at<double>(count,64) >> hus.at<double>(count,65) >> hus.at<double>(count,66) >> hus.at<double>(count,67) >> hus.at<double>(count,68) >> hus.at<double>(count,69) >> hus.at<double>(count,70) >> hus.at<double>(count,71) >> hus.at<double>(count,72) >> hus.at<double>(count,73) >> hus.at<double>(count,74) >> hus.at<double>(count,75) >> hus.at<double>(count,76) >> hus.at<double>(count,77) >> hus.at<double>(count,78) >> hus.at<double>(count,79) >> hus.at<double>(count,80) >> hus.at<double>(count,81) >> hus.at<double>(count,82) >> hus.at<double>(count,83) >> hus.at<double>(count,84) >> hus.at<double>(count,85) >> hus.at<double>(count,86) >> hus.at<double>(count,87) >> hus.at<double>(count,88) >> hus.at<double>(count,89) >> hus.at<double>(count,90) >> hus.at<double>(count,91) >> hus.at<double>(count,92) >> hus.at<double>(count,93) >> hus.at<double>(count,94) >> hus.at<double>(count,95) >> hus.at<double>(count,96) >> hus.at<double>(count,97) >> hus.at<double>(count,98) >> hus.at<double>(count,99) >> hus.at<double>(count,100) >> hus.at<double>(count,101) >> hus.at<double>(count,102) >> hus.at<double>(count,103) >> hus.at<double>(count,104) >> hus.at<double>(count,105) >> hus.at<double>(count,106) >> hus.at<double>(count,107) >> hus.at<double>(count,108) >> hus.at<double>(count,109) >> hus.at<double>(count,110) >> hus.at<double>(count,111) >> hus.at<double>(count,112) >> hus.at<double>(count,113) >> hus.at<double>(count,114) >> hus.at<double>(count,115) >> hus.at<double>(count,116) >> hus.at<double>(count,117) >> hus.at<double>(count,118) >> hus.at<double>(count,119) >> hus.at<double>(count,120) >> hus.at<double>(count,121) >> hus.at<double>(count,122) >> hus.at<double>(count,123) >> hus.at<double>(count,124) >> hus.at<double>(count,125) >> hus.at<double>(count,126) >> hus.at<double>(count,127) >> hus.at<double>(count,128) >> hus.at<double>(count,129) >> hus.at<double>(count,130) >> hus.at<double>(count,131) >> hus.at<double>(count,132) >> hus.at<double>(count,133) >> hus.at<double>(count,134) >> hus.at<double>(count,135) >> hus.at<double>(count,136) >> hus.at<double>(count,137) >> hus.at<double>(count,138) >> hus.at<double>(count,139) >> hus.at<double>(count,140) >> hus.at<double>(count,141) >> hus.at<double>(count,142) >> hus.at<double>(count,143) >> hus.at<double>(count,144) >> hus.at<double>(count,145) >> hus.at<double>(count,146) >> hus.at<double>(count,147) >> hus.at<double>(count,148) >> hus.at<double>(count,149) >> hus.at<double>(count,150) >> hus.at<double>(count,151) >> hus.at<double>(count,152) >> hus.at<double>(count,153) >> hus.at<double>(count,154) >> hus.at<double>(count,155) >> hus.at<double>(count,156) >> hus.at<double>(count,157) >> hus.at<double>(count,158) >> hus.at<double>(count,159) >> hus.at<double>(count,160) >> hus.at<double>(count,161) >> hus.at<double>(count,162) >> hus.at<double>(count,163) >> hus.at<double>(count,164) >> hus.at<double>(count,165) >> hus.at<double>(count,166) >> hus.at<double>(count,167) >> hus.at<double>(count,168) >> hus.at<double>(count,169) >> hus.at<double>(count,170) >> hus.at<double>(count,171) >> hus.at<double>(count,172) >> hus.at<double>(count,173) >> hus.at<double>(count,174) >> hus.at<double>(count,175) >> hus.at<double>(count,176) >> hus.at<double>(count,177) >> hus.at<double>(count,178) >> hus.at<double>(count,179) >> hus.at<double>(count,180) >> hus.at<double>(count,181) >> hus.at<double>(count,182) >> hus.at<double>(count,183) >> hus.at<double>(count,184) >> hus.at<double>(count,185) >> hus.at<double>(count,186) >> hus.at<double>(count,187) >> hus.at<double>(count,188) >> hus.at<double>(count,189) >> hus.at<double>(count,190) >> hus.at<double>(count,191) >> hus.at<double>(count,192) >> hus.at<double>(count,193) >> hus.at<double>(count,194) >> hus.at<double>(count,195) >> hus.at<double>(count,196) >> hus.at<double>(count,197) >> hus.at<double>(count,198) >> hus.at<double>(count,199) >> hus.at<double>(count,200) >> hus.at<double>(count,201) >> hus.at<double>(count,202) >> hus.at<double>(count,203) >> hus.at<double>(count,204) >> hus.at<double>(count,205) >> hus.at<double>(count,206) >> hus.at<double>(count,207) >> hus.at<double>(count,208) >> hus.at<double>(count,209) >> hus.at<double>(count,210) >> hus.at<double>(count,211) >> hus.at<double>(count,212) >> hus.at<double>(count,213) >> hus.at<double>(count,214) >> hus.at<double>(count,215) >> hus.at<double>(count,216) >> hus.at<double>(count,217) >> hus.at<double>(count,218) >> hus.at<double>(count,219) >> hus.at<double>(count,220) >> hus.at<double>(count,221) >> hus.at<double>(count,222) >> hus.at<double>(count,223) >> hus.at<double>(count,224) >> hus.at<double>(count,225) >> hus.at<double>(count,226) >> hus.at<double>(count,227) >> hus.at<double>(count,228) >> hus.at<double>(count,229) >> hus.at<double>(count,230) >> hus.at<double>(count,231) >> hus.at<double>(count,232) >> hus.at<double>(count,233) >> hus.at<double>(count,234) >> hus.at<double>(count,235) >> hus.at<double>(count,236) >> hus.at<double>(count,237) >> hus.at<double>(count,238) >> hus.at<double>(count,239) >> hus.at<double>(count,240) >> hus.at<double>(count,241) >> hus.at<double>(count,242) >> hus.at<double>(count,243) >> hus.at<double>(count,244) >> hus.at<double>(count,245) >> hus.at<double>(count,246) >> hus.at<double>(count,247) >> hus.at<double>(count,248) >> hus.at<double>(count,249) >> hus.at<double>(count,250) >> hus.at<double>(count,251) >> hus.at<double>(count,252) >> hus.at<double>(count,253) >> hus.at<double>(count,254) >> hus.at<double>(count,255) >> hus.at<double>(count,256) >> hus.at<double>(count,257) >> hus.at<double>(count,258) >> hus.at<double>(count,259) >> hus.at<double>(count,260) >> hus.at<double>(count,261) >> hus.at<double>(count,262) >> hus.at<double>(count,263) >> hus.at<double>(count,264) >> hus.at<double>(count,265) >> hus.at<double>(count,266) >> hus.at<double>(count,267) >> hus.at<double>(count,268) >> hus.at<double>(count,269) >> hus.at<double>(count,270) >> hus.at<double>(count,271) >> hus.at<double>(count,272) >> hus.at<double>(count,273) >> hus.at<double>(count,274) >> hus.at<double>(count,275) >> hus.at<double>(count,276) >> hus.at<double>(count,277) >> hus.at<double>(count,278) >> hus.at<double>(count,279) >> hus.at<double>(count,280) >> hus.at<double>(count,281) >> hus.at<double>(count,282) >> hus.at<double>(count,283) >> hus.at<double>(count,284) >> hus.at<double>(count,285) >> hus.at<double>(count,286) >> hus.at<double>(count,287) >> hus.at<double>(count,288) >> hus.at<double>(count,289) >> hus.at<double>(count,290) >> hus.at<double>(count,291) >> hus.at<double>(count,292) >> hus.at<double>(count,293) >> hus.at<double>(count,294) >> hus.at<double>(count,295) >> hus.at<double>(count,296) >> hus.at<double>(count,297) >> hus.at<double>(count,298) >> hus.at<double>(count,299) >> hus.at<double>(count,300) >> hus.at<double>(count,301) >> hus.at<double>(count,302) >> hus.at<double>(count,303) >> hus.at<double>(count,304) >> hus.at<double>(count,305) >> hus.at<double>(count,306) >> hus.at<double>(count,307) >> hus.at<double>(count,308) >> hus.at<double>(count,309) >> hus.at<double>(count,310) >> hus.at<double>(count,311) >> hus.at<double>(count,312) >> hus.at<double>(count,313) >> hus.at<double>(count,314) >> hus.at<double>(count,315) >> hus.at<double>(count,316) >> hus.at<double>(count,317) >> hus.at<double>(count,318) >> hus.at<double>(count,319) >> hus.at<double>(count,320) >> hus.at<double>(count,321) >> hus.at<double>(count,322) >> hus.at<double>(count,323) >> hus.at<double>(count,324) >> hus.at<double>(count,325) >> hus.at<double>(count,326) >> hus.at<double>(count,327) >> hus.at<double>(count,328) >> hus.at<double>(count,329) >> hus.at<double>(count,330) >> hus.at<double>(count,331) >> hus.at<double>(count,332) >> hus.at<double>(count,333) >> hus.at<double>(count,334) >> hus.at<double>(count,335) >> hus.at<double>(count,336) >> hus.at<double>(count,337) >> hus.at<double>(count,338) >> hus.at<double>(count,339) >> hus.at<double>(count,340) >> hus.at<double>(count,341) >> hus.at<double>(count,342) >> hus.at<double>(count,343) >> hus.at<double>(count,344) >> hus.at<double>(count,345) >> hus.at<double>(count,346) >> hus.at<double>(count,347) >> hus.at<double>(count,348) >> hus.at<double>(count,349) >> hus.at<double>(count,350) >> hus.at<double>(count,351) >> hus.at<double>(count,352) >> hus.at<double>(count,353) >> hus.at<double>(count,354) >> hus.at<double>(count,355) >> hus.at<double>(count,356) >> hus.at<double>(count,357) >> hus.at<double>(count,358) >> hus.at<double>(count,359) >> hus.at<double>(count,360) >> hus.at<double>(count,361) >> hus.at<double>(count,362) >> hus.at<double>(count,363) >> hus.at<double>(count,364) >> hus.at<double>(count,365) >> hus.at<double>(count,366) >> hus.at<double>(count,367) >> hus.at<double>(count,368) >> hus.at<double>(count,369) >> hus.at<double>(count,370) >> hus.at<double>(count,371) >> hus.at<double>(count,372) >> hus.at<double>(count,373) >> hus.at<double>(count,374) >> hus.at<double>(count,375) >> hus.at<double>(count,376) >> hus.at<double>(count,377) >> hus.at<double>(count,378) >> hus.at<double>(count,379) >> hus.at<double>(count,380) >> hus.at<double>(count,381) >> hus.at<double>(count,382) >> hus.at<double>(count,383) >> hus.at<double>(count,384) >> hus.at<double>(count,385) >> hus.at<double>(count,386) >> hus.at<double>(count,387) >> hus.at<double>(count,388) >> hus.at<double>(count,389) >> hus.at<double>(count,390) >> hus.at<double>(count,391) >> hus.at<double>(count,392) >> hus.at<double>(count,393) >> hus.at<double>(count,394) >> hus.at<double>(count,395) >> hus.at<double>(count,396) >> hus.at<double>(count,397) >> hus.at<double>(count,398) >> hus.at<double>(count,399) >> hus.at<double>(count,400) >> hus.at<double>(count,401) >> hus.at<double>(count,402) >> hus.at<double>(count,403) >> hus.at<double>(count,404) >> hus.at<double>(count,405) >> hus.at<double>(count,406) >> hus.at<double>(count,407) >> hus.at<double>(count,408) >> hus.at<double>(count,409) >> hus.at<double>(count,410) >> hus.at<double>(count,411) >> hus.at<double>(count,412) >> hus.at<double>(count,413) >> hus.at<double>(count,414) >> hus.at<double>(count,415) >> hus.at<double>(count,416) >> hus.at<double>(count,417) >> hus.at<double>(count,418) >> hus.at<double>(count,419) >> hus.at<double>(count,420) >> hus.at<double>(count,421) >> hus.at<double>(count,422) >> hus.at<double>(count,423) >> hus.at<double>(count,424) >> hus.at<double>(count,425) >> hus.at<double>(count,426) >> hus.at<double>(count,427) >> hus.at<double>(count,428) >> hus.at<double>(count,429) >> hus.at<double>(count,430) >> hus.at<double>(count,431) >> hus.at<double>(count,432) >> hus.at<double>(count,433) >> hus.at<double>(count,434) >> hus.at<double>(count,435) >> hus.at<double>(count,436) >> hus.at<double>(count,437) >> hus.at<double>(count,438) >> hus.at<double>(count,439) >> hus.at<double>(count,440) >> hus.at<double>(count,441) >> hus.at<double>(count,442) >> hus.at<double>(count,443) >> hus.at<double>(count,444) >> hus.at<double>(count,445) >> hus.at<double>(count,446) >> hus.at<double>(count,447) >> hus.at<double>(count,448) >> hus.at<double>(count,449) >> hus.at<double>(count,450) >> hus.at<double>(count,451) >> hus.at<double>(count,452) >> hus.at<double>(count,453) >> hus.at<double>(count,454) >> hus.at<double>(count,455) >> hus.at<double>(count,456) >> hus.at<double>(count,457) >> hus.at<double>(count,458) >> hus.at<double>(count,459) >> hus.at<double>(count,460) >> hus.at<double>(count,461) >> hus.at<double>(count,462) >> hus.at<double>(count,463) >> hus.at<double>(count,464) >> hus.at<double>(count,465) >> hus.at<double>(count,466) >> hus.at<double>(count,467) >> hus.at<double>(count,468) >> hus.at<double>(count,469) >> hus.at<double>(count,470) >> hus.at<double>(count,471) >> hus.at<double>(count,472) >> hus.at<double>(count,473) >> hus.at<double>(count,474) >> hus.at<double>(count,475) >> hus.at<double>(count,476) >> hus.at<double>(count,477) >> hus.at<double>(count,478) >> hus.at<double>(count,479) >> hus.at<double>(count,480) >> hus.at<double>(count,481) >> hus.at<double>(count,482) >> hus.at<double>(count,483) >> hus.at<double>(count,484) >> hus.at<double>(count,485) >> hus.at<double>(count,486) >> hus.at<double>(count,487) >> hus.at<double>(count,488) >> hus.at<double>(count,489) >> hus.at<double>(count,490) >> hus.at<double>(count,491) >> hus.at<double>(count,492) >> hus.at<double>(count,493) >> hus.at<double>(count,494) >> hus.at<double>(count,495) >> hus.at<double>(count,496) >> hus.at<double>(count,497) >> hus.at<double>(count,498) >> hus.at<double>(count,499) >> hus.at<double>(count,500) >> hus.at<double>(count,501) >> hus.at<double>(count,502) >> hus.at<double>(count,503) >> hus.at<double>(count,504) >> hus.at<double>(count,505) >> hus.at<double>(count,506) >> hus.at<double>(count,507) >> hus.at<double>(count,508) >> hus.at<double>(count,509) >> hus.at<double>(count,510) >> hus.at<double>(count,511) >> hus.at<double>(count,512) >> hus.at<double>(count,513) >> hus.at<double>(count,514) >> hus.at<double>(count,515) >> hus.at<double>(count,516) >> hus.at<double>(count,517) >> hus.at<double>(count,518) >> hus.at<double>(count,519) >> hus.at<double>(count,520) >> hus.at<double>(count,521) >> hus.at<double>(count,522) >> hus.at<double>(count,523) >> hus.at<double>(count,524) >> hus.at<double>(count,525) >> hus.at<double>(count,526) >> hus.at<double>(count,527) >> hus.at<double>(count,528) >> hus.at<double>(count,529) >> hus.at<double>(count,530) >> hus.at<double>(count,531) >> hus.at<double>(count,532) >> hus.at<double>(count,533) >> hus.at<double>(count,534) >> hus.at<double>(count,535) >> hus.at<double>(count,536) >> hus.at<double>(count,537) >> hus.at<double>(count,538) >> hus.at<double>(count,539) >> hus.at<double>(count,540) >> hus.at<double>(count,541) >> hus.at<double>(count,542) >> hus.at<double>(count,543) >> hus.at<double>(count,544) >> hus.at<double>(count,545) >> hus.at<double>(count,546) >> hus.at<double>(count,547) >> hus.at<double>(count,548) >> hus.at<double>(count,549) >> hus.at<double>(count,550) >> hus.at<double>(count,551) >> hus.at<double>(count,552) >> hus.at<double>(count,553) >> hus.at<double>(count,554) >> hus.at<double>(count,555) >> hus.at<double>(count,556) >> hus.at<double>(count,557) >> hus.at<double>(count,558) >> hus.at<double>(count,559) >> hus.at<double>(count,560) >> hus.at<double>(count,561) >> hus.at<double>(count,562) >> hus.at<double>(count,563) >> hus.at<double>(count,564) >> hus.at<double>(count,565) >> hus.at<double>(count,566) >> hus.at<double>(count,567) >> hus.at<double>(count,568) >> hus.at<double>(count,569) >> hus.at<double>(count,570) >> hus.at<double>(count,571) >> hus.at<double>(count,572) >> hus.at<double>(count,573) >> hus.at<double>(count,574) >> hus.at<double>(count,575) >> hus.at<double>(count,576) >> hus.at<double>(count,577) >> hus.at<double>(count,578) >> hus.at<double>(count,579) >> hus.at<double>(count,580) >> hus.at<double>(count,581) >> hus.at<double>(count,582) >> hus.at<double>(count,583) >> hus.at<double>(count,584) >> hus.at<double>(count,585) >> hus.at<double>(count,586) >> hus.at<double>(count,587) >> hus.at<double>(count,588) >> hus.at<double>(count,589) >> hus.at<double>(count,590) >> hus.at<double>(count,591) >> hus.at<double>(count,592) >> hus.at<double>(count,593) >> hus.at<double>(count,594) >> hus.at<double>(count,595) >> hus.at<double>(count,596) >> hus.at<double>(count,597) >> hus.at<double>(count,598) >> hus.at<double>(count,599) >> hus.at<double>(count,600) >> hus.at<double>(count,601) >> hus.at<double>(count,602) >> hus.at<double>(count,603) >> hus.at<double>(count,604) >> hus.at<double>(count,605) >> hus.at<double>(count,606) >> hus.at<double>(count,607) >> hus.at<double>(count,608) >> hus.at<double>(count,609) >> hus.at<double>(count,610) >> hus.at<double>(count,611) >> hus.at<double>(count,612) >> hus.at<double>(count,613) >> hus.at<double>(count,614) >> hus.at<double>(count,615) >> hus.at<double>(count,616) >> hus.at<double>(count,617) >> hus.at<double>(count,618) >> hus.at<double>(count,619) >> hus.at<double>(count,620) >> hus.at<double>(count,621) >> hus.at<double>(count,622) >> hus.at<double>(count,623) >> hus.at<double>(count,624) >> hus.at<double>(count,625) >> hus.at<double>(count,626) >> hus.at<double>(count,627) >> hus.at<double>(count,628) >> hus.at<double>(count,629) >> hus.at<double>(count,630) >> hus.at<double>(count,631) >> hus.at<double>(count,632) >> hus.at<double>(count,633) >> hus.at<double>(count,634) >> hus.at<double>(count,635) >> hus.at<double>(count,636) >> hus.at<double>(count,637) >> hus.at<double>(count,638) >> hus.at<double>(count,639) >> hus.at<double>(count,640) >> hus.at<double>(count,641) >> hus.at<double>(count,642) >> hus.at<double>(count,643) >> hus.at<double>(count,644) >> hus.at<double>(count,645) >> hus.at<double>(count,646) >> hus.at<double>(count,647) >> hus.at<double>(count,648) >> hus.at<double>(count,649) >> hus.at<double>(count,650) >> hus.at<double>(count,651) >> hus.at<double>(count,652) >> hus.at<double>(count,653) >> hus.at<double>(count,654) >> hus.at<double>(count,655) >> hus.at<double>(count,656) >> hus.at<double>(count,657) >> hus.at<double>(count,658) >> hus.at<double>(count,659) >> hus.at<double>(count,660) >> hus.at<double>(count,661) >> hus.at<double>(count,662) >> hus.at<double>(count,663) >> hus.at<double>(count,664) >> hus.at<double>(count,665) >> hus.at<double>(count,666) >> hus.at<double>(count,667) >> hus.at<double>(count,668) >> hus.at<double>(count,669) >> hus.at<double>(count,670) >> hus.at<double>(count,671) >> hus.at<double>(count,672) >> hus.at<double>(count,673) >> hus.at<double>(count,674) >> hus.at<double>(count,675) >> hus.at<double>(count,676) >> hus.at<double>(count,677) >> hus.at<double>(count,678) >> hus.at<double>(count,679) >> hus.at<double>(count,680) >> hus.at<double>(count,681) >> hus.at<double>(count,682) >> hus.at<double>(count,683) >> hus.at<double>(count,684) >> hus.at<double>(count,685) >> hus.at<double>(count,686) >> hus.at<double>(count,687) >> hus.at<double>(count,688) >> hus.at<double>(count,689) >> hus.at<double>(count,690) >> hus.at<double>(count,691) >> hus.at<double>(count,692) >> hus.at<double>(count,693) >> hus.at<double>(count,694) >> hus.at<double>(count,695) >> hus.at<double>(count,696) >> hus.at<double>(count,697) >> hus.at<double>(count,698) >> hus.at<double>(count,699) >> hus.at<double>(count,700) >> hus.at<double>(count,701) >> hus.at<double>(count,702) >> hus.at<double>(count,703) >> hus.at<double>(count,704) >> hus.at<double>(count,705) >> hus.at<double>(count,706) >> hus.at<double>(count,707) >> hus.at<double>(count,708) >> hus.at<double>(count,709) >> hus.at<double>(count,710) >> hus.at<double>(count,711) >> hus.at<double>(count,712) >> hus.at<double>(count,713) >> hus.at<double>(count,714) >> hus.at<double>(count,715) >> hus.at<double>(count,716) >> hus.at<double>(count,717) >> hus.at<double>(count,718) >> hus.at<double>(count,719) >> hus.at<double>(count,720) >> hus.at<double>(count,721) >> hus.at<double>(count,722) >> hus.at<double>(count,723) >> hus.at<double>(count,724) >> hus.at<double>(count,725) >> hus.at<double>(count,726) >> hus.at<double>(count,727) >> hus.at<double>(count,728) >> hus.at<double>(count,729) >> hus.at<double>(count,730) >> hus.at<double>(count,731) >> hus.at<double>(count,732) >> hus.at<double>(count,733) >> hus.at<double>(count,734) >> hus.at<double>(count,735) >> hus.at<double>(count,736) >> hus.at<double>(count,737) >> hus.at<double>(count,738) >> hus.at<double>(count,739) >> hus.at<double>(count,740) >> hus.at<double>(count,741) >> hus.at<double>(count,742) >> hus.at<double>(count,743) >> hus.at<double>(count,744) >> hus.at<double>(count,745) >> hus.at<double>(count,746) >> hus.at<double>(count,747) >> hus.at<double>(count,748) >> hus.at<double>(count,749) >> hus.at<double>(count,750) >> hus.at<double>(count,751) >> hus.at<double>(count,752) >> hus.at<double>(count,753) >> hus.at<double>(count,754) >> hus.at<double>(count,755) >> hus.at<double>(count,756) >> hus.at<double>(count,757) >> hus.at<double>(count,758) >> hus.at<double>(count,759) >> hus.at<double>(count,760) >> hus.at<double>(count,761) >> hus.at<double>(count,762) >> hus.at<double>(count,763) >> hus.at<double>(count,764) >> hus.at<double>(count,765) >> hus.at<double>(count,766) >> hus.at<double>(count,767) >> hus.at<double>(count,768) >> hus.at<double>(count,769) >> hus.at<double>(count,770) >> hus.at<double>(count,771) >> hus.at<double>(count,772) >> hus.at<double>(count,773) >> hus.at<double>(count,774) >> hus.at<double>(count,775) >> hus.at<double>(count,776) >> hus.at<double>(count,777) >> hus.at<double>(count,778) >> hus.at<double>(count,779) >> hus.at<double>(count,780) >> hus.at<double>(count,781) >> hus.at<double>(count,782) >> hus.at<double>(count,783) >> hus.at<double>(count,784) >> hus.at<double>(count,785) >> hus.at<double>(count,786) >> hus.at<double>(count,787) >> hus.at<double>(count,788) >> hus.at<double>(count,789) >> hus.at<double>(count,790) >> hus.at<double>(count,791) >> hus.at<double>(count,792) >> hus.at<double>(count,793) >> hus.at<double>(count,794) >> hus.at<double>(count,795) >> hus.at<double>(count,796) >> hus.at<double>(count,797) >> hus.at<double>(count,798) >> hus.at<double>(count,799) >> hus.at<double>(count,800) >> hus.at<double>(count,801) >> hus.at<double>(count,802) >> hus.at<double>(count,803) >> hus.at<double>(count,804) >> hus.at<double>(count,805) >> hus.at<double>(count,806) >> hus.at<double>(count,807) >> hus.at<double>(count,808) >> hus.at<double>(count,809) >> hus.at<double>(count,810) >> hus.at<double>(count,811) >> hus.at<double>(count,812) >> hus.at<double>(count,813) >> hus.at<double>(count,814) >> hus.at<double>(count,815) >> hus.at<double>(count,816) >> hus.at<double>(count,817) >> hus.at<double>(count,818) >> hus.at<double>(count,819) >> hus.at<double>(count,820) >> hus.at<double>(count,821) >> hus.at<double>(count,822) >> hus.at<double>(count,823) >> hus.at<double>(count,824) >> hus.at<double>(count,825) >> hus.at<double>(count,826) >> hus.at<double>(count,827) >> hus.at<double>(count,828) >> hus.at<double>(count,829) >> hus.at<double>(count,830) >> hus.at<double>(count,831) >> hus.at<double>(count,832) >> hus.at<double>(count,833) >> hus.at<double>(count,834) >> hus.at<double>(count,835) >> hus.at<double>(count,836) >> hus.at<double>(count,837) >> hus.at<double>(count,838) >> hus.at<double>(count,839) >> hus.at<double>(count,840) >> hus.at<double>(count,841) >> hus.at<double>(count,842) >> hus.at<double>(count,843) >> hus.at<double>(count,844) >> hus.at<double>(count,845) >> hus.at<double>(count,846) >> hus.at<double>(count,847) >> hus.at<double>(count,848) >> hus.at<double>(count,849) >> hus.at<double>(count,850) >> hus.at<double>(count,851) >> hus.at<double>(count,852) >> hus.at<double>(count,853) >> hus.at<double>(count,854) >> hus.at<double>(count,855) >> hus.at<double>(count,856) >> hus.at<double>(count,857) >> hus.at<double>(count,858) >> hus.at<double>(count,859) >> hus.at<double>(count,860) >> hus.at<double>(count,861) >> hus.at<double>(count,862) >> hus.at<double>(count,863) >> hus.at<double>(count,864) >> hus.at<double>(count,865) >> hus.at<double>(count,866) >> hus.at<double>(count,867) >> hus.at<double>(count,868) >> hus.at<double>(count,869) >> hus.at<double>(count,870) >> hus.at<double>(count,871) >> hus.at<double>(count,872) >> hus.at<double>(count,873) >> hus.at<double>(count,874) >> hus.at<double>(count,875) >> hus.at<double>(count,876) >> hus.at<double>(count,877) >> hus.at<double>(count,878) >> hus.at<double>(count,879) >> hus.at<double>(count,880) >> hus.at<double>(count,881) >> hus.at<double>(count,882) >> hus.at<double>(count,883) >> hus.at<double>(count,884) >> hus.at<double>(count,885) >> hus.at<double>(count,886) >> hus.at<double>(count,887) >> hus.at<double>(count,888) >> hus.at<double>(count,889) >> hus.at<double>(count,890) >> hus.at<double>(count,891) >> hus.at<double>(count,892) >> hus.at<double>(count,893) >> hus.at<double>(count,894) >> hus.at<double>(count,895) >> hus.at<double>(count,896) >> hus.at<double>(count,897) >> hus.at<double>(count,898) >> hus.at<double>(count,899) >> hus.at<double>(count,900) >> hus.at<double>(count,901) >> hus.at<double>(count,902) >> hus.at<double>(count,903) >> hus.at<double>(count,904) >> hus.at<double>(count,905) >> hus.at<double>(count,906) >> hus.at<double>(count,907) >> hus.at<double>(count,908) >> hus.at<double>(count,909) >> hus.at<double>(count,910) >> hus.at<double>(count,911) >> hus.at<double>(count,912) >> hus.at<double>(count,913) >> hus.at<double>(count,914) >> hus.at<double>(count,915) >> hus.at<double>(count,916) >> hus.at<double>(count,917) >> hus.at<double>(count,918) >> hus.at<double>(count,919) >> hus.at<double>(count,920) >> hus.at<double>(count,921) >> hus.at<double>(count,922) >> hus.at<double>(count,923) >> hus.at<double>(count,924) >> hus.at<double>(count,925) >> hus.at<double>(count,926) >> hus.at<double>(count,927) >> hus.at<double>(count,928) >> hus.at<double>(count,929) >> hus.at<double>(count,930) >> hus.at<double>(count,931) >> hus.at<double>(count,932) >> hus.at<double>(count,933) >> hus.at<double>(count,934) >> hus.at<double>(count,935) >> hus.at<double>(count,936) >> hus.at<double>(count,937) >> hus.at<double>(count,938) >> hus.at<double>(count,939) >> hus.at<double>(count,940) >> hus.at<double>(count,941) >> hus.at<double>(count,942) >> hus.at<double>(count,943) >> hus.at<double>(count,944) >> hus.at<double>(count,945) >> hus.at<double>(count,946) >> hus.at<double>(count,947) >> hus.at<double>(count,948) >> hus.at<double>(count,949) >> hus.at<double>(count,950) >> hus.at<double>(count,951) >> hus.at<double>(count,952) >> hus.at<double>(count,953) >> hus.at<double>(count,954) >> hus.at<double>(count,955) >> hus.at<double>(count,956) >> hus.at<double>(count,957) >> hus.at<double>(count,958) >> hus.at<double>(count,959) >> hus.at<double>(count,960) >> hus.at<double>(count,961) >> hus.at<double>(count,962) >> hus.at<double>(count,963) >> hus.at<double>(count,964) >> hus.at<double>(count,965) >> hus.at<double>(count,966) >> hus.at<double>(count,967) >> hus.at<double>(count,968) >> hus.at<double>(count,969) >> hus.at<double>(count,970) >> hus.at<double>(count,971) >> hus.at<double>(count,972) >> hus.at<double>(count,973) >> hus.at<double>(count,974) >> hus.at<double>(count,975) >> hus.at<double>(count,976) >> hus.at<double>(count,977) >> hus.at<double>(count,978) >> hus.at<double>(count,979) >> hus.at<double>(count,980) >> hus.at<double>(count,981) >> hus.at<double>(count,982) >> hus.at<double>(count,983) >> hus.at<double>(count,984) >> hus.at<double>(count,985) >> hus.at<double>(count,986) >> hus.at<double>(count,987) >> hus.at<double>(count,988) >> hus.at<double>(count,989) >> hus.at<double>(count,990) >> hus.at<double>(count,991) >> hus.at<double>(count,992) >> hus.at<double>(count,993) >> hus.at<double>(count,994) >> hus.at<double>(count,995) >> hus.at<double>(count,996) >> hus.at<double>(count,997) >> hus.at<double>(count,998))
{
  //cout << hus.row(count) << endl;
  labels.at<double>(count,label) = 1.0;
  count++;
}

/* STEP 2. Create and train the Neural Network */
//1. Declare the classifier
CvANN_MLP mlp;


ifstream ifile("./trained_mlp.xml");
if (ifile) 
{
	// The file exists, so we don't need to train 
	printf("Loading network from file ... \n");
	mlp.load("./trained_mlp.xml", "mlp");
} else {
  //1. Create the MLP with 3 layers
  Mat layers = Mat(3, 1, CV_32SC1);
  layers.row(0) = Scalar(num_features);
  layers.row(1) = Scalar(400);
  layers.row(2) = Scalar(num_classes);
  mlp.create(layers,CvANN_MLP::SIGMOID_SYM,0.6,1);
	CvANN_MLP_TrainParams params;
	CvTermCriteria criteria;
	criteria.max_iter = 1000;
	criteria.epsilon = 0.000001f;
	criteria.type = CV_TERMCRIT_ITER | CV_TERMCRIT_EPS;
	params.train_method = CvANN_MLP_TrainParams::BACKPROP;
	params.bp_dw_scale = 0.05f;
	params.bp_moment_scale = 0.05f;
	params.term_crit = criteria;

	//2. Train it 
	printf("Training ... \n");
	mlp.train(hus, labels, Mat(), Mat(), params, 0);

	// Save the trained classifier
	mlp.save("./trained_mlp.xml", "mlp");
}

/* STEP 3. Calculating the testing and training error */
Mat predictions;
mlp.predict(hus,predictions);
int tp=0;
int fp=0;
for (int i=0; i<predictions.rows; i++)
{
  int maxLabelIdx = 0;
  double maxLabelVal = -1;
  int maxPredIdx = 0;
  double maxPredVal = -1;
  for (int j=0; j<predictions.cols; j++)
  {
    if (predictions.at<double>(i,j)>maxPredVal)
    {
      maxPredVal = predictions.at<double>(i,j);
      maxPredIdx = j;
    }
    if (labels.at<double>(i,j)>maxLabelVal)
    {
      maxLabelVal = labels.at<double>(i,j);
      maxLabelIdx = j;
    }
  }

  if (maxLabelIdx == maxPredIdx)
      tp++;
  else 
      fp++;
}
cout << "Train Accuracy = " << (float)tp/(tp+fp) << endl;


ifstream test_infile("test_data.txt");

num_samples = 5198; 
hus = Mat(num_samples,num_features,CV_64FC1);
labels = Mat::ones(num_samples,num_classes,CV_64FC1);
labels = labels * -1;
count = 0;

while (test_infile >> label >> hus.at<double>(count,0) >> hus.at<double>(count,1) >> hus.at<double>(count,2) >> hus.at<double>(count,3) >> hus.at<double>(count,4) >> hus.at<double>(count,5) >> hus.at<double>(count,6) >> hus.at<double>(count,7) >> hus.at<double>(count,8) >> hus.at<double>(count,9) >> hus.at<double>(count,10) >> hus.at<double>(count,11) >> hus.at<double>(count,12) >> hus.at<double>(count,13) >> hus.at<double>(count,14) >> hus.at<double>(count,15) >> hus.at<double>(count,16) >> hus.at<double>(count,17) >> hus.at<double>(count,18) >> hus.at<double>(count,19) >> hus.at<double>(count,20) >> hus.at<double>(count,21) >> hus.at<double>(count,22) >> hus.at<double>(count,23) >> hus.at<double>(count,24) >> hus.at<double>(count,25) >> hus.at<double>(count,26) >> hus.at<double>(count,27) >> hus.at<double>(count,28) >> hus.at<double>(count,29) >> hus.at<double>(count,30) >> hus.at<double>(count,31) >> hus.at<double>(count,32) >> hus.at<double>(count,33) >> hus.at<double>(count,34) >> hus.at<double>(count,35) >> hus.at<double>(count,36) >> hus.at<double>(count,37) >> hus.at<double>(count,38) >> hus.at<double>(count,39) >> hus.at<double>(count,40) >> hus.at<double>(count,41) >> hus.at<double>(count,42) >> hus.at<double>(count,43) >> hus.at<double>(count,44) >> hus.at<double>(count,45) >> hus.at<double>(count,46) >> hus.at<double>(count,47) >> hus.at<double>(count,48) >> hus.at<double>(count,49) >> hus.at<double>(count,50) >> hus.at<double>(count,51) >> hus.at<double>(count,52) >> hus.at<double>(count,53) >> hus.at<double>(count,54) >> hus.at<double>(count,55) >> hus.at<double>(count,56) >> hus.at<double>(count,57) >> hus.at<double>(count,58) >> hus.at<double>(count,59) >> hus.at<double>(count,60) >> hus.at<double>(count,61) >> hus.at<double>(count,62) >> hus.at<double>(count,63) >> hus.at<double>(count,64) >> hus.at<double>(count,65) >> hus.at<double>(count,66) >> hus.at<double>(count,67) >> hus.at<double>(count,68) >> hus.at<double>(count,69) >> hus.at<double>(count,70) >> hus.at<double>(count,71) >> hus.at<double>(count,72) >> hus.at<double>(count,73) >> hus.at<double>(count,74) >> hus.at<double>(count,75) >> hus.at<double>(count,76) >> hus.at<double>(count,77) >> hus.at<double>(count,78) >> hus.at<double>(count,79) >> hus.at<double>(count,80) >> hus.at<double>(count,81) >> hus.at<double>(count,82) >> hus.at<double>(count,83) >> hus.at<double>(count,84) >> hus.at<double>(count,85) >> hus.at<double>(count,86) >> hus.at<double>(count,87) >> hus.at<double>(count,88) >> hus.at<double>(count,89) >> hus.at<double>(count,90) >> hus.at<double>(count,91) >> hus.at<double>(count,92) >> hus.at<double>(count,93) >> hus.at<double>(count,94) >> hus.at<double>(count,95) >> hus.at<double>(count,96) >> hus.at<double>(count,97) >> hus.at<double>(count,98) >> hus.at<double>(count,99) >> hus.at<double>(count,100) >> hus.at<double>(count,101) >> hus.at<double>(count,102) >> hus.at<double>(count,103) >> hus.at<double>(count,104) >> hus.at<double>(count,105) >> hus.at<double>(count,106) >> hus.at<double>(count,107) >> hus.at<double>(count,108) >> hus.at<double>(count,109) >> hus.at<double>(count,110) >> hus.at<double>(count,111) >> hus.at<double>(count,112) >> hus.at<double>(count,113) >> hus.at<double>(count,114) >> hus.at<double>(count,115) >> hus.at<double>(count,116) >> hus.at<double>(count,117) >> hus.at<double>(count,118) >> hus.at<double>(count,119) >> hus.at<double>(count,120) >> hus.at<double>(count,121) >> hus.at<double>(count,122) >> hus.at<double>(count,123) >> hus.at<double>(count,124) >> hus.at<double>(count,125) >> hus.at<double>(count,126) >> hus.at<double>(count,127) >> hus.at<double>(count,128) >> hus.at<double>(count,129) >> hus.at<double>(count,130) >> hus.at<double>(count,131) >> hus.at<double>(count,132) >> hus.at<double>(count,133) >> hus.at<double>(count,134) >> hus.at<double>(count,135) >> hus.at<double>(count,136) >> hus.at<double>(count,137) >> hus.at<double>(count,138) >> hus.at<double>(count,139) >> hus.at<double>(count,140) >> hus.at<double>(count,141) >> hus.at<double>(count,142) >> hus.at<double>(count,143) >> hus.at<double>(count,144) >> hus.at<double>(count,145) >> hus.at<double>(count,146) >> hus.at<double>(count,147) >> hus.at<double>(count,148) >> hus.at<double>(count,149) >> hus.at<double>(count,150) >> hus.at<double>(count,151) >> hus.at<double>(count,152) >> hus.at<double>(count,153) >> hus.at<double>(count,154) >> hus.at<double>(count,155) >> hus.at<double>(count,156) >> hus.at<double>(count,157) >> hus.at<double>(count,158) >> hus.at<double>(count,159) >> hus.at<double>(count,160) >> hus.at<double>(count,161) >> hus.at<double>(count,162) >> hus.at<double>(count,163) >> hus.at<double>(count,164) >> hus.at<double>(count,165) >> hus.at<double>(count,166) >> hus.at<double>(count,167) >> hus.at<double>(count,168) >> hus.at<double>(count,169) >> hus.at<double>(count,170) >> hus.at<double>(count,171) >> hus.at<double>(count,172) >> hus.at<double>(count,173) >> hus.at<double>(count,174) >> hus.at<double>(count,175) >> hus.at<double>(count,176) >> hus.at<double>(count,177) >> hus.at<double>(count,178) >> hus.at<double>(count,179) >> hus.at<double>(count,180) >> hus.at<double>(count,181) >> hus.at<double>(count,182) >> hus.at<double>(count,183) >> hus.at<double>(count,184) >> hus.at<double>(count,185) >> hus.at<double>(count,186) >> hus.at<double>(count,187) >> hus.at<double>(count,188) >> hus.at<double>(count,189) >> hus.at<double>(count,190) >> hus.at<double>(count,191) >> hus.at<double>(count,192) >> hus.at<double>(count,193) >> hus.at<double>(count,194) >> hus.at<double>(count,195) >> hus.at<double>(count,196) >> hus.at<double>(count,197) >> hus.at<double>(count,198) >> hus.at<double>(count,199) >> hus.at<double>(count,200) >> hus.at<double>(count,201) >> hus.at<double>(count,202) >> hus.at<double>(count,203) >> hus.at<double>(count,204) >> hus.at<double>(count,205) >> hus.at<double>(count,206) >> hus.at<double>(count,207) >> hus.at<double>(count,208) >> hus.at<double>(count,209) >> hus.at<double>(count,210) >> hus.at<double>(count,211) >> hus.at<double>(count,212) >> hus.at<double>(count,213) >> hus.at<double>(count,214) >> hus.at<double>(count,215) >> hus.at<double>(count,216) >> hus.at<double>(count,217) >> hus.at<double>(count,218) >> hus.at<double>(count,219) >> hus.at<double>(count,220) >> hus.at<double>(count,221) >> hus.at<double>(count,222) >> hus.at<double>(count,223) >> hus.at<double>(count,224) >> hus.at<double>(count,225) >> hus.at<double>(count,226) >> hus.at<double>(count,227) >> hus.at<double>(count,228) >> hus.at<double>(count,229) >> hus.at<double>(count,230) >> hus.at<double>(count,231) >> hus.at<double>(count,232) >> hus.at<double>(count,233) >> hus.at<double>(count,234) >> hus.at<double>(count,235) >> hus.at<double>(count,236) >> hus.at<double>(count,237) >> hus.at<double>(count,238) >> hus.at<double>(count,239) >> hus.at<double>(count,240) >> hus.at<double>(count,241) >> hus.at<double>(count,242) >> hus.at<double>(count,243) >> hus.at<double>(count,244) >> hus.at<double>(count,245) >> hus.at<double>(count,246) >> hus.at<double>(count,247) >> hus.at<double>(count,248) >> hus.at<double>(count,249) >> hus.at<double>(count,250) >> hus.at<double>(count,251) >> hus.at<double>(count,252) >> hus.at<double>(count,253) >> hus.at<double>(count,254) >> hus.at<double>(count,255) >> hus.at<double>(count,256) >> hus.at<double>(count,257) >> hus.at<double>(count,258) >> hus.at<double>(count,259) >> hus.at<double>(count,260) >> hus.at<double>(count,261) >> hus.at<double>(count,262) >> hus.at<double>(count,263) >> hus.at<double>(count,264) >> hus.at<double>(count,265) >> hus.at<double>(count,266) >> hus.at<double>(count,267) >> hus.at<double>(count,268) >> hus.at<double>(count,269) >> hus.at<double>(count,270) >> hus.at<double>(count,271) >> hus.at<double>(count,272) >> hus.at<double>(count,273) >> hus.at<double>(count,274) >> hus.at<double>(count,275) >> hus.at<double>(count,276) >> hus.at<double>(count,277) >> hus.at<double>(count,278) >> hus.at<double>(count,279) >> hus.at<double>(count,280) >> hus.at<double>(count,281) >> hus.at<double>(count,282) >> hus.at<double>(count,283) >> hus.at<double>(count,284) >> hus.at<double>(count,285) >> hus.at<double>(count,286) >> hus.at<double>(count,287) >> hus.at<double>(count,288) >> hus.at<double>(count,289) >> hus.at<double>(count,290) >> hus.at<double>(count,291) >> hus.at<double>(count,292) >> hus.at<double>(count,293) >> hus.at<double>(count,294) >> hus.at<double>(count,295) >> hus.at<double>(count,296) >> hus.at<double>(count,297) >> hus.at<double>(count,298) >> hus.at<double>(count,299) >> hus.at<double>(count,300) >> hus.at<double>(count,301) >> hus.at<double>(count,302) >> hus.at<double>(count,303) >> hus.at<double>(count,304) >> hus.at<double>(count,305) >> hus.at<double>(count,306) >> hus.at<double>(count,307) >> hus.at<double>(count,308) >> hus.at<double>(count,309) >> hus.at<double>(count,310) >> hus.at<double>(count,311) >> hus.at<double>(count,312) >> hus.at<double>(count,313) >> hus.at<double>(count,314) >> hus.at<double>(count,315) >> hus.at<double>(count,316) >> hus.at<double>(count,317) >> hus.at<double>(count,318) >> hus.at<double>(count,319) >> hus.at<double>(count,320) >> hus.at<double>(count,321) >> hus.at<double>(count,322) >> hus.at<double>(count,323) >> hus.at<double>(count,324) >> hus.at<double>(count,325) >> hus.at<double>(count,326) >> hus.at<double>(count,327) >> hus.at<double>(count,328) >> hus.at<double>(count,329) >> hus.at<double>(count,330) >> hus.at<double>(count,331) >> hus.at<double>(count,332) >> hus.at<double>(count,333) >> hus.at<double>(count,334) >> hus.at<double>(count,335) >> hus.at<double>(count,336) >> hus.at<double>(count,337) >> hus.at<double>(count,338) >> hus.at<double>(count,339) >> hus.at<double>(count,340) >> hus.at<double>(count,341) >> hus.at<double>(count,342) >> hus.at<double>(count,343) >> hus.at<double>(count,344) >> hus.at<double>(count,345) >> hus.at<double>(count,346) >> hus.at<double>(count,347) >> hus.at<double>(count,348) >> hus.at<double>(count,349) >> hus.at<double>(count,350) >> hus.at<double>(count,351) >> hus.at<double>(count,352) >> hus.at<double>(count,353) >> hus.at<double>(count,354) >> hus.at<double>(count,355) >> hus.at<double>(count,356) >> hus.at<double>(count,357) >> hus.at<double>(count,358) >> hus.at<double>(count,359) >> hus.at<double>(count,360) >> hus.at<double>(count,361) >> hus.at<double>(count,362) >> hus.at<double>(count,363) >> hus.at<double>(count,364) >> hus.at<double>(count,365) >> hus.at<double>(count,366) >> hus.at<double>(count,367) >> hus.at<double>(count,368) >> hus.at<double>(count,369) >> hus.at<double>(count,370) >> hus.at<double>(count,371) >> hus.at<double>(count,372) >> hus.at<double>(count,373) >> hus.at<double>(count,374) >> hus.at<double>(count,375) >> hus.at<double>(count,376) >> hus.at<double>(count,377) >> hus.at<double>(count,378) >> hus.at<double>(count,379) >> hus.at<double>(count,380) >> hus.at<double>(count,381) >> hus.at<double>(count,382) >> hus.at<double>(count,383) >> hus.at<double>(count,384) >> hus.at<double>(count,385) >> hus.at<double>(count,386) >> hus.at<double>(count,387) >> hus.at<double>(count,388) >> hus.at<double>(count,389) >> hus.at<double>(count,390) >> hus.at<double>(count,391) >> hus.at<double>(count,392) >> hus.at<double>(count,393) >> hus.at<double>(count,394) >> hus.at<double>(count,395) >> hus.at<double>(count,396) >> hus.at<double>(count,397) >> hus.at<double>(count,398) >> hus.at<double>(count,399) >> hus.at<double>(count,400) >> hus.at<double>(count,401) >> hus.at<double>(count,402) >> hus.at<double>(count,403) >> hus.at<double>(count,404) >> hus.at<double>(count,405) >> hus.at<double>(count,406) >> hus.at<double>(count,407) >> hus.at<double>(count,408) >> hus.at<double>(count,409) >> hus.at<double>(count,410) >> hus.at<double>(count,411) >> hus.at<double>(count,412) >> hus.at<double>(count,413) >> hus.at<double>(count,414) >> hus.at<double>(count,415) >> hus.at<double>(count,416) >> hus.at<double>(count,417) >> hus.at<double>(count,418) >> hus.at<double>(count,419) >> hus.at<double>(count,420) >> hus.at<double>(count,421) >> hus.at<double>(count,422) >> hus.at<double>(count,423) >> hus.at<double>(count,424) >> hus.at<double>(count,425) >> hus.at<double>(count,426) >> hus.at<double>(count,427) >> hus.at<double>(count,428) >> hus.at<double>(count,429) >> hus.at<double>(count,430) >> hus.at<double>(count,431) >> hus.at<double>(count,432) >> hus.at<double>(count,433) >> hus.at<double>(count,434) >> hus.at<double>(count,435) >> hus.at<double>(count,436) >> hus.at<double>(count,437) >> hus.at<double>(count,438) >> hus.at<double>(count,439) >> hus.at<double>(count,440) >> hus.at<double>(count,441) >> hus.at<double>(count,442) >> hus.at<double>(count,443) >> hus.at<double>(count,444) >> hus.at<double>(count,445) >> hus.at<double>(count,446) >> hus.at<double>(count,447) >> hus.at<double>(count,448) >> hus.at<double>(count,449) >> hus.at<double>(count,450) >> hus.at<double>(count,451) >> hus.at<double>(count,452) >> hus.at<double>(count,453) >> hus.at<double>(count,454) >> hus.at<double>(count,455) >> hus.at<double>(count,456) >> hus.at<double>(count,457) >> hus.at<double>(count,458) >> hus.at<double>(count,459) >> hus.at<double>(count,460) >> hus.at<double>(count,461) >> hus.at<double>(count,462) >> hus.at<double>(count,463) >> hus.at<double>(count,464) >> hus.at<double>(count,465) >> hus.at<double>(count,466) >> hus.at<double>(count,467) >> hus.at<double>(count,468) >> hus.at<double>(count,469) >> hus.at<double>(count,470) >> hus.at<double>(count,471) >> hus.at<double>(count,472) >> hus.at<double>(count,473) >> hus.at<double>(count,474) >> hus.at<double>(count,475) >> hus.at<double>(count,476) >> hus.at<double>(count,477) >> hus.at<double>(count,478) >> hus.at<double>(count,479) >> hus.at<double>(count,480) >> hus.at<double>(count,481) >> hus.at<double>(count,482) >> hus.at<double>(count,483) >> hus.at<double>(count,484) >> hus.at<double>(count,485) >> hus.at<double>(count,486) >> hus.at<double>(count,487) >> hus.at<double>(count,488) >> hus.at<double>(count,489) >> hus.at<double>(count,490) >> hus.at<double>(count,491) >> hus.at<double>(count,492) >> hus.at<double>(count,493) >> hus.at<double>(count,494) >> hus.at<double>(count,495) >> hus.at<double>(count,496) >> hus.at<double>(count,497) >> hus.at<double>(count,498) >> hus.at<double>(count,499) >> hus.at<double>(count,500) >> hus.at<double>(count,501) >> hus.at<double>(count,502) >> hus.at<double>(count,503) >> hus.at<double>(count,504) >> hus.at<double>(count,505) >> hus.at<double>(count,506) >> hus.at<double>(count,507) >> hus.at<double>(count,508) >> hus.at<double>(count,509) >> hus.at<double>(count,510) >> hus.at<double>(count,511) >> hus.at<double>(count,512) >> hus.at<double>(count,513) >> hus.at<double>(count,514) >> hus.at<double>(count,515) >> hus.at<double>(count,516) >> hus.at<double>(count,517) >> hus.at<double>(count,518) >> hus.at<double>(count,519) >> hus.at<double>(count,520) >> hus.at<double>(count,521) >> hus.at<double>(count,522) >> hus.at<double>(count,523) >> hus.at<double>(count,524) >> hus.at<double>(count,525) >> hus.at<double>(count,526) >> hus.at<double>(count,527) >> hus.at<double>(count,528) >> hus.at<double>(count,529) >> hus.at<double>(count,530) >> hus.at<double>(count,531) >> hus.at<double>(count,532) >> hus.at<double>(count,533) >> hus.at<double>(count,534) >> hus.at<double>(count,535) >> hus.at<double>(count,536) >> hus.at<double>(count,537) >> hus.at<double>(count,538) >> hus.at<double>(count,539) >> hus.at<double>(count,540) >> hus.at<double>(count,541) >> hus.at<double>(count,542) >> hus.at<double>(count,543) >> hus.at<double>(count,544) >> hus.at<double>(count,545) >> hus.at<double>(count,546) >> hus.at<double>(count,547) >> hus.at<double>(count,548) >> hus.at<double>(count,549) >> hus.at<double>(count,550) >> hus.at<double>(count,551) >> hus.at<double>(count,552) >> hus.at<double>(count,553) >> hus.at<double>(count,554) >> hus.at<double>(count,555) >> hus.at<double>(count,556) >> hus.at<double>(count,557) >> hus.at<double>(count,558) >> hus.at<double>(count,559) >> hus.at<double>(count,560) >> hus.at<double>(count,561) >> hus.at<double>(count,562) >> hus.at<double>(count,563) >> hus.at<double>(count,564) >> hus.at<double>(count,565) >> hus.at<double>(count,566) >> hus.at<double>(count,567) >> hus.at<double>(count,568) >> hus.at<double>(count,569) >> hus.at<double>(count,570) >> hus.at<double>(count,571) >> hus.at<double>(count,572) >> hus.at<double>(count,573) >> hus.at<double>(count,574) >> hus.at<double>(count,575) >> hus.at<double>(count,576) >> hus.at<double>(count,577) >> hus.at<double>(count,578) >> hus.at<double>(count,579) >> hus.at<double>(count,580) >> hus.at<double>(count,581) >> hus.at<double>(count,582) >> hus.at<double>(count,583) >> hus.at<double>(count,584) >> hus.at<double>(count,585) >> hus.at<double>(count,586) >> hus.at<double>(count,587) >> hus.at<double>(count,588) >> hus.at<double>(count,589) >> hus.at<double>(count,590) >> hus.at<double>(count,591) >> hus.at<double>(count,592) >> hus.at<double>(count,593) >> hus.at<double>(count,594) >> hus.at<double>(count,595) >> hus.at<double>(count,596) >> hus.at<double>(count,597) >> hus.at<double>(count,598) >> hus.at<double>(count,599) >> hus.at<double>(count,600) >> hus.at<double>(count,601) >> hus.at<double>(count,602) >> hus.at<double>(count,603) >> hus.at<double>(count,604) >> hus.at<double>(count,605) >> hus.at<double>(count,606) >> hus.at<double>(count,607) >> hus.at<double>(count,608) >> hus.at<double>(count,609) >> hus.at<double>(count,610) >> hus.at<double>(count,611) >> hus.at<double>(count,612) >> hus.at<double>(count,613) >> hus.at<double>(count,614) >> hus.at<double>(count,615) >> hus.at<double>(count,616) >> hus.at<double>(count,617) >> hus.at<double>(count,618) >> hus.at<double>(count,619) >> hus.at<double>(count,620) >> hus.at<double>(count,621) >> hus.at<double>(count,622) >> hus.at<double>(count,623) >> hus.at<double>(count,624) >> hus.at<double>(count,625) >> hus.at<double>(count,626) >> hus.at<double>(count,627) >> hus.at<double>(count,628) >> hus.at<double>(count,629) >> hus.at<double>(count,630) >> hus.at<double>(count,631) >> hus.at<double>(count,632) >> hus.at<double>(count,633) >> hus.at<double>(count,634) >> hus.at<double>(count,635) >> hus.at<double>(count,636) >> hus.at<double>(count,637) >> hus.at<double>(count,638) >> hus.at<double>(count,639) >> hus.at<double>(count,640) >> hus.at<double>(count,641) >> hus.at<double>(count,642) >> hus.at<double>(count,643) >> hus.at<double>(count,644) >> hus.at<double>(count,645) >> hus.at<double>(count,646) >> hus.at<double>(count,647) >> hus.at<double>(count,648) >> hus.at<double>(count,649) >> hus.at<double>(count,650) >> hus.at<double>(count,651) >> hus.at<double>(count,652) >> hus.at<double>(count,653) >> hus.at<double>(count,654) >> hus.at<double>(count,655) >> hus.at<double>(count,656) >> hus.at<double>(count,657) >> hus.at<double>(count,658) >> hus.at<double>(count,659) >> hus.at<double>(count,660) >> hus.at<double>(count,661) >> hus.at<double>(count,662) >> hus.at<double>(count,663) >> hus.at<double>(count,664) >> hus.at<double>(count,665) >> hus.at<double>(count,666) >> hus.at<double>(count,667) >> hus.at<double>(count,668) >> hus.at<double>(count,669) >> hus.at<double>(count,670) >> hus.at<double>(count,671) >> hus.at<double>(count,672) >> hus.at<double>(count,673) >> hus.at<double>(count,674) >> hus.at<double>(count,675) >> hus.at<double>(count,676) >> hus.at<double>(count,677) >> hus.at<double>(count,678) >> hus.at<double>(count,679) >> hus.at<double>(count,680) >> hus.at<double>(count,681) >> hus.at<double>(count,682) >> hus.at<double>(count,683) >> hus.at<double>(count,684) >> hus.at<double>(count,685) >> hus.at<double>(count,686) >> hus.at<double>(count,687) >> hus.at<double>(count,688) >> hus.at<double>(count,689) >> hus.at<double>(count,690) >> hus.at<double>(count,691) >> hus.at<double>(count,692) >> hus.at<double>(count,693) >> hus.at<double>(count,694) >> hus.at<double>(count,695) >> hus.at<double>(count,696) >> hus.at<double>(count,697) >> hus.at<double>(count,698) >> hus.at<double>(count,699) >> hus.at<double>(count,700) >> hus.at<double>(count,701) >> hus.at<double>(count,702) >> hus.at<double>(count,703) >> hus.at<double>(count,704) >> hus.at<double>(count,705) >> hus.at<double>(count,706) >> hus.at<double>(count,707) >> hus.at<double>(count,708) >> hus.at<double>(count,709) >> hus.at<double>(count,710) >> hus.at<double>(count,711) >> hus.at<double>(count,712) >> hus.at<double>(count,713) >> hus.at<double>(count,714) >> hus.at<double>(count,715) >> hus.at<double>(count,716) >> hus.at<double>(count,717) >> hus.at<double>(count,718) >> hus.at<double>(count,719) >> hus.at<double>(count,720) >> hus.at<double>(count,721) >> hus.at<double>(count,722) >> hus.at<double>(count,723) >> hus.at<double>(count,724) >> hus.at<double>(count,725) >> hus.at<double>(count,726) >> hus.at<double>(count,727) >> hus.at<double>(count,728) >> hus.at<double>(count,729) >> hus.at<double>(count,730) >> hus.at<double>(count,731) >> hus.at<double>(count,732) >> hus.at<double>(count,733) >> hus.at<double>(count,734) >> hus.at<double>(count,735) >> hus.at<double>(count,736) >> hus.at<double>(count,737) >> hus.at<double>(count,738) >> hus.at<double>(count,739) >> hus.at<double>(count,740) >> hus.at<double>(count,741) >> hus.at<double>(count,742) >> hus.at<double>(count,743) >> hus.at<double>(count,744) >> hus.at<double>(count,745) >> hus.at<double>(count,746) >> hus.at<double>(count,747) >> hus.at<double>(count,748) >> hus.at<double>(count,749) >> hus.at<double>(count,750) >> hus.at<double>(count,751) >> hus.at<double>(count,752) >> hus.at<double>(count,753) >> hus.at<double>(count,754) >> hus.at<double>(count,755) >> hus.at<double>(count,756) >> hus.at<double>(count,757) >> hus.at<double>(count,758) >> hus.at<double>(count,759) >> hus.at<double>(count,760) >> hus.at<double>(count,761) >> hus.at<double>(count,762) >> hus.at<double>(count,763) >> hus.at<double>(count,764) >> hus.at<double>(count,765) >> hus.at<double>(count,766) >> hus.at<double>(count,767) >> hus.at<double>(count,768) >> hus.at<double>(count,769) >> hus.at<double>(count,770) >> hus.at<double>(count,771) >> hus.at<double>(count,772) >> hus.at<double>(count,773) >> hus.at<double>(count,774) >> hus.at<double>(count,775) >> hus.at<double>(count,776) >> hus.at<double>(count,777) >> hus.at<double>(count,778) >> hus.at<double>(count,779) >> hus.at<double>(count,780) >> hus.at<double>(count,781) >> hus.at<double>(count,782) >> hus.at<double>(count,783) >> hus.at<double>(count,784) >> hus.at<double>(count,785) >> hus.at<double>(count,786) >> hus.at<double>(count,787) >> hus.at<double>(count,788) >> hus.at<double>(count,789) >> hus.at<double>(count,790) >> hus.at<double>(count,791) >> hus.at<double>(count,792) >> hus.at<double>(count,793) >> hus.at<double>(count,794) >> hus.at<double>(count,795) >> hus.at<double>(count,796) >> hus.at<double>(count,797) >> hus.at<double>(count,798) >> hus.at<double>(count,799) >> hus.at<double>(count,800) >> hus.at<double>(count,801) >> hus.at<double>(count,802) >> hus.at<double>(count,803) >> hus.at<double>(count,804) >> hus.at<double>(count,805) >> hus.at<double>(count,806) >> hus.at<double>(count,807) >> hus.at<double>(count,808) >> hus.at<double>(count,809) >> hus.at<double>(count,810) >> hus.at<double>(count,811) >> hus.at<double>(count,812) >> hus.at<double>(count,813) >> hus.at<double>(count,814) >> hus.at<double>(count,815) >> hus.at<double>(count,816) >> hus.at<double>(count,817) >> hus.at<double>(count,818) >> hus.at<double>(count,819) >> hus.at<double>(count,820) >> hus.at<double>(count,821) >> hus.at<double>(count,822) >> hus.at<double>(count,823) >> hus.at<double>(count,824) >> hus.at<double>(count,825) >> hus.at<double>(count,826) >> hus.at<double>(count,827) >> hus.at<double>(count,828) >> hus.at<double>(count,829) >> hus.at<double>(count,830) >> hus.at<double>(count,831) >> hus.at<double>(count,832) >> hus.at<double>(count,833) >> hus.at<double>(count,834) >> hus.at<double>(count,835) >> hus.at<double>(count,836) >> hus.at<double>(count,837) >> hus.at<double>(count,838) >> hus.at<double>(count,839) >> hus.at<double>(count,840) >> hus.at<double>(count,841) >> hus.at<double>(count,842) >> hus.at<double>(count,843) >> hus.at<double>(count,844) >> hus.at<double>(count,845) >> hus.at<double>(count,846) >> hus.at<double>(count,847) >> hus.at<double>(count,848) >> hus.at<double>(count,849) >> hus.at<double>(count,850) >> hus.at<double>(count,851) >> hus.at<double>(count,852) >> hus.at<double>(count,853) >> hus.at<double>(count,854) >> hus.at<double>(count,855) >> hus.at<double>(count,856) >> hus.at<double>(count,857) >> hus.at<double>(count,858) >> hus.at<double>(count,859) >> hus.at<double>(count,860) >> hus.at<double>(count,861) >> hus.at<double>(count,862) >> hus.at<double>(count,863) >> hus.at<double>(count,864) >> hus.at<double>(count,865) >> hus.at<double>(count,866) >> hus.at<double>(count,867) >> hus.at<double>(count,868) >> hus.at<double>(count,869) >> hus.at<double>(count,870) >> hus.at<double>(count,871) >> hus.at<double>(count,872) >> hus.at<double>(count,873) >> hus.at<double>(count,874) >> hus.at<double>(count,875) >> hus.at<double>(count,876) >> hus.at<double>(count,877) >> hus.at<double>(count,878) >> hus.at<double>(count,879) >> hus.at<double>(count,880) >> hus.at<double>(count,881) >> hus.at<double>(count,882) >> hus.at<double>(count,883) >> hus.at<double>(count,884) >> hus.at<double>(count,885) >> hus.at<double>(count,886) >> hus.at<double>(count,887) >> hus.at<double>(count,888) >> hus.at<double>(count,889) >> hus.at<double>(count,890) >> hus.at<double>(count,891) >> hus.at<double>(count,892) >> hus.at<double>(count,893) >> hus.at<double>(count,894) >> hus.at<double>(count,895) >> hus.at<double>(count,896) >> hus.at<double>(count,897) >> hus.at<double>(count,898) >> hus.at<double>(count,899) >> hus.at<double>(count,900) >> hus.at<double>(count,901) >> hus.at<double>(count,902) >> hus.at<double>(count,903) >> hus.at<double>(count,904) >> hus.at<double>(count,905) >> hus.at<double>(count,906) >> hus.at<double>(count,907) >> hus.at<double>(count,908) >> hus.at<double>(count,909) >> hus.at<double>(count,910) >> hus.at<double>(count,911) >> hus.at<double>(count,912) >> hus.at<double>(count,913) >> hus.at<double>(count,914) >> hus.at<double>(count,915) >> hus.at<double>(count,916) >> hus.at<double>(count,917) >> hus.at<double>(count,918) >> hus.at<double>(count,919) >> hus.at<double>(count,920) >> hus.at<double>(count,921) >> hus.at<double>(count,922) >> hus.at<double>(count,923) >> hus.at<double>(count,924) >> hus.at<double>(count,925) >> hus.at<double>(count,926) >> hus.at<double>(count,927) >> hus.at<double>(count,928) >> hus.at<double>(count,929) >> hus.at<double>(count,930) >> hus.at<double>(count,931) >> hus.at<double>(count,932) >> hus.at<double>(count,933) >> hus.at<double>(count,934) >> hus.at<double>(count,935) >> hus.at<double>(count,936) >> hus.at<double>(count,937) >> hus.at<double>(count,938) >> hus.at<double>(count,939) >> hus.at<double>(count,940) >> hus.at<double>(count,941) >> hus.at<double>(count,942) >> hus.at<double>(count,943) >> hus.at<double>(count,944) >> hus.at<double>(count,945) >> hus.at<double>(count,946) >> hus.at<double>(count,947) >> hus.at<double>(count,948) >> hus.at<double>(count,949) >> hus.at<double>(count,950) >> hus.at<double>(count,951) >> hus.at<double>(count,952) >> hus.at<double>(count,953) >> hus.at<double>(count,954) >> hus.at<double>(count,955) >> hus.at<double>(count,956) >> hus.at<double>(count,957) >> hus.at<double>(count,958) >> hus.at<double>(count,959) >> hus.at<double>(count,960) >> hus.at<double>(count,961) >> hus.at<double>(count,962) >> hus.at<double>(count,963) >> hus.at<double>(count,964) >> hus.at<double>(count,965) >> hus.at<double>(count,966) >> hus.at<double>(count,967) >> hus.at<double>(count,968) >> hus.at<double>(count,969) >> hus.at<double>(count,970) >> hus.at<double>(count,971) >> hus.at<double>(count,972) >> hus.at<double>(count,973) >> hus.at<double>(count,974) >> hus.at<double>(count,975) >> hus.at<double>(count,976) >> hus.at<double>(count,977) >> hus.at<double>(count,978) >> hus.at<double>(count,979) >> hus.at<double>(count,980) >> hus.at<double>(count,981) >> hus.at<double>(count,982) >> hus.at<double>(count,983) >> hus.at<double>(count,984) >> hus.at<double>(count,985) >> hus.at<double>(count,986) >> hus.at<double>(count,987) >> hus.at<double>(count,988) >> hus.at<double>(count,989) >> hus.at<double>(count,990) >> hus.at<double>(count,991) >> hus.at<double>(count,992) >> hus.at<double>(count,993) >> hus.at<double>(count,994) >> hus.at<double>(count,995) >> hus.at<double>(count,996) >> hus.at<double>(count,997) >> hus.at<double>(count,998))
{

  labels.at<double>(count,label) = 1.0;
  count++;
}

mlp.predict(hus,predictions);
tp=0;
fp=0;
for (int i=0; i<predictions.rows; i++)
{
  int maxLabelIdx = 0;
  double maxLabelVal = -1000;
  int maxPredIdx = 0;
  double maxPredVal = -1000;
  for (int j=0; j<predictions.cols; j++)
  {
    if (predictions.at<double>(i,j)>maxPredVal)
    {
      maxPredVal = predictions.at<double>(i,j);
      maxPredIdx = j;
    }
    if (labels.at<double>(i,j)>maxLabelVal)
    {
      maxLabelVal = labels.at<double>(i,j);
      maxLabelIdx = j;
    }
  }

  if (maxLabelIdx == maxPredIdx)
      tp++;
  else 
      fp++;
}
cout << "Test Accuracy = " << (float)tp/(tp+fp) << endl;

//Predict an individual sample
/*double t = cvGetTickCount();
static const double arr[] = {0, 0, 0, 0, 0, 0, 0.08403361344537814, 0.4134453781512605, 0, 0, 0, 0.02817126850740296, 0.1382953181272509, 0, 0, 0.007763105242096838, 0.226890756302521, 0.3563025210084033, 0.1228491396558623, 0, 0.01728691476590636, 0.2735494197679071, 0.1229291716686675, 0.2688275310124049, 0, 0, 0, 0, 0, 0, 0, 0, 0.4460984393757502, 0.04153661464585834, 0, 0, 0, 0.07354941976790716, 0.003761504601840736, 0, 0, 0, 0.2674669867947179, 0.03073229291716686, 0, 0, 0, 0, 0, 0, 0.0330532212885154, 0.1086034413765506, 0, 0, 0, 0.1591836734693877, 0.5202881152460984, 0.2996398559423769, 0.05186074429771909, 0, 0.1624649859943977, 0.5305322128851541, 0.06322529011604641, 0.01528611444577831, 0, 0.1591836734693877, 0.5202881152460984, 0.3968787515006002, 0.09563825530212083, 0, 0.0330532212885154, 0.1086034413765506, 0.114125650260104, 0.02737094837935174, 0, 0, 0, 0, 0, 0, 0, 0, 0.1571028411364546, 0.02088835534213685, 0, 0, 0, 0.2801120448179271, 0.0224889955982393, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.01728691476590636, 0.4008803521408563, 0.4756302521008403, 0.3643857543017207, 0.005442176870748299, 0.007763105242096838, 0.2, 0.2976390556222489, 0.166546618647459, 0.002561024409763905, 0, 0.06762705082032812, 0.3322128851540616, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0602641056422569, 0.0399359743897559, 0, 0, 0, 0.1369347739095638, 0.1018807523009204, 0.4272909163665466, 0.003841536614645858, 0, 0, 0, 0.230812324929972, 0.01536614645858343, 0, 0, 0, 0, 0, 0, 0, 0, 0.1256502601040416, 0.01600640256102441, 0, 0.1643857543017207, 0.2143257302921168, 0.6086434573829531, 0.07186874749899959, 0, 0.07891156462585033, 0.04233693477390956, 0.6837134853941575, 0.01056422569027611, 0, 0.3807923169267707, 0.09027611044417767, 0.6300120048019208, 0.03057222889155662, 0, 0.07458983593437375, 0.01784713885554222, 0.09243697478991596, 0, 0, 0, 0, 0, 0, 0, 0.1509403761504602, 0.338375350140056, 0.1389355742296919, 0.007282913165266106, 0, 0.0399359743897559, 0.05986394557823128, 0.3394957983193277, 0.006722689075630252, 0, 0.2946778711484594, 0.1931972789115646, 0.3236494597839135, 0.01400560224089636, 0, 0.1374149659863945, 0.01656662665066026, 0.1535814325730292, 0}; //R

hus = Mat(1,num_features,CV_64FC1,(void*)&arr);
mlp.predict( hus, predictions);
int maxPredIdx = 0; float maxPredVal = -1000;
printf("\n The char sample may be one of: ");
for (int j=0; j<predictions.cols; j++)
{
  if (predictions.at<double>(0,j)>-0.3)
    cout << ascii[j] << "(" << predictions.at<double>(0,j) << ")  ";
  if (predictions.at<double>(0,j)>maxPredVal)
  { maxPredVal = predictions.at<double>(0,j); maxPredIdx = j;}
}

printf("\n The char sample is predicted as: %s \n\n", ascii[maxPredIdx]);
t = cvGetTickCount() - t;
printf("\n Time elapsed for individual sample prediction = %gms\n", t*1000./cv::getTickFrequency());
*/


return EXIT_SUCCESS;
}
